import onnx
from onnx import shape_inference

# Load ONNX model
model_path = "your_model.onnx"
model = onnx.load(model_path)

# Run shape inference
inferred_model = shape_inference.infer_shapes(model)

# Save the inferred model
onnx.save(inferred_model, "inferred_model.onnx")

# Print inferred model graph
print(onnx.helper.printable_graph(inferred_model.graph))
