 def auto_fp16_wrapper(old_func):

        @functools.wraps(old_func)
        def new_func(*args, **kwargs):
            # check if the module has set the attribute `fp16_enabled`, if not,
            # just fallback to the original method.
            if not isinstance(args[0], supported_types):
                raise TypeError('@auto_fp16 can only be used to decorate the '
                                f'method of those classes {supported_types}')
            if not (hasattr(args[0], 'fp16_enabled') and args[0].fp16_enabled):
                return old_func(*args, **kwargs)



{'rescale': True, 'img_metas': [[{'flip': False, 'pcd_horizontal_flip': False, 'pcd_vertical_flip': False, 'box_mode_3d': <Box3DMode.LIDAR: 0>, 'box_type_3d': <class 'mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes'>, 'sample_idx': '30e55a3ec6184d8cb1944b39ba19d622', 'pcd_scale_factor': 1.0, 'pts_filename': 'data/nuscenes/samples/LIDAR_TOP/n015-2018-07-11-11-54-16+0800__LIDAR_TOP__1531281439800013.pcd.bin'}]]



{
    'rescale': True,
    'img_metas': [
        [
            {
                'flip': False,
                'pcd_horizontal_flip': False,
                'pcd_vertical_flip': False,
                'box_mode_3d': Box3DMode.LIDAR,
                'box_type_3d': mmdet3d.core.bbox.structures.lidar_box3d.LiDARInstance3DBoxes,
                'sample_idx': '30e55a3ec6184d8cb1944b39ba19d622',
                'pcd_scale_factor': 1.0,
                'pts_filename': 'data/nuscenes/samples/LIDAR_TOP/n015-2018-07-11-11-54-16+0800__LIDAR_TOP__1531281439800013.pcd.bin'
            }
        ]
    ]
}


  File "/usr/local/lib/python3.8/dist-packages/mmcv/runner/fp16_utils.py", line 124, in new_func
    return old_func(*args,**kwargs)
  File "/workspace/flashocc/FlashOCC/mmdetection3d/mmdet3d/models/detectors/base.py", line 74, in forward
    return self.forward_test(**kwargs)
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/detectors/bevdet.py", line 216, in forward_test
    return self.simple_test(points[0], img_metas[0], img_inputs[0],
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/detectors/bevdet_occ.py", line 168, in simple_test
    img_feats, _, _ = self.extract_feat(
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/detectors/bevdet.py", line 126, in extract_feat
    img_feats, depth = self.extract_img_feat(img_inputs, img_metas, **kwargs)
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/detectors/bevdet.py", line 106, in extract_img_feat
    x, depth = self.img_view_transformer([x] + img_inputs[1:7])
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1106, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1094, in _slow_forward
    result = self.forward(*input, **kwargs)
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/necks/view_transformer.py", line 431, in forward
    return self.view_transform(input, depth, tran_feat)
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/necks/view_transformer.py", line 404, in view_transform
    return self.view_transform_core(input, depth, tran_feat)
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/necks/view_transformer.py", line 380, in view_transform_core
    bev_feat = self.voxel_pooling_v2(
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/models/necks/view_transformer.py", line 261, in voxel_pooling_v2
    bev_feat = bev_pool_v2(depth, feat, ranks_depth, ranks_feat, ranks_bev,
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/ops/bev_pool_v2/bev_pool.py", line 102, in bev_pool_v2
    x = QuickCumsumCuda.apply(depth, feat, ranks_depth, ranks_feat, ranks_bev,
  File "/workspace/flashocc/FlashOCC/projects/mmdet3d_plugin/ops/bev_pool_v2/bev_pool.py", line 29, in forward
    bev_pool_v2_ext.bev_pool_v2_forward(
RuntimeError: t == DeviceType::CUDAINTERNAL ASSERT FAILED at "/usr/local/lib/python3.8/dist-packages/torch/include/c10/cuda/impl/CUDAGuardImpl.h":24, please report a bug to PyTorch. 







