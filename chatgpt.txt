import torch
import torch.onnx

# Define a simple model using einsum
class EinsumModel(torch.nn.Module):
    def forward(self, x, y):
        return torch.einsum('ij,ik->jk', x, y)

# Create the model
model = EinsumModel()

# Generate dummy inputs
x = torch.randn(1, 240)
y = torch.randn(1, 236)

# Export the model to ONNX
onnx_filename = "einsum_model.onnx"
torch.onnx.export(model, (x, y), onnx_filename, 
                  input_names=["x", "y"], output_names=["output"],
                  opset_version=12, dynamic_axes={"x": {0: "batch"}, "y": {0: "batch"}})

print(f"ONNX model exported to {onnx_filename}")
