import onnx

# Load the ONNX model
model_path = "your_model.onnx"
model = onnx.load(model_path)

# Find Resize node and change attribute from scales -> sizes
for node in model.graph.node:
    if node.op_type == "Resize":
        print(f"Fixing Resize Node: {node.name}")

        # Iterate through the attributes to modify 'scales' â†’ 'sizes'
        for attr in node.attribute:
            if attr.name == "scales":
                print(f"Changing attribute '{attr.name}' to 'sizes'")
                attr.name = "sizes"

# Save the modified model
onnx.save(model, "fixed_model.onnx")
print("Successfully changed Resize attribute from 'scales' to 'sizes'!")
