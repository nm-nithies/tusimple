import onnx
from onnx import helper

# Load the ONNX model
model_path = "model.onnx"  # Replace with your model path
model = onnx.load(model_path)

# Access the model graph
graph = model.graph

# Iterate through the nodes to find the ReduceMean op
for node in graph.node:
    if node.op_type == "ReduceMean":
        print("Original ReduceMean node attributes:", node)
        
        # Modify the axis attribute
        for attr in node.attribute:
            if attr.name == "axes":
                print("Original axes:", attr.ints)
                attr.ints[:] = [1]  # Update the axis value to [1] (or your desired value)
                print("Updated axes:", attr.ints)

# Save the modified ONNX model
modified_model_path = "modified_model.onnx"
onnx.save(model, modified_model_path)

print(f"Modified model saved at {modified_model_path}")
