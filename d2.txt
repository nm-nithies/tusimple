import torch
import torch.nn as nn
import numpy as np

x = np.load("/remote/us01sgnfs00562/NNSDK/amajala/onnx_model/tensor1_256_768.npy")
layer_norm = nn.LayerNorm(x.shape,9.999999960041972e-13)

s = np.load("/remote/us01sgnfs00562/NNSDK/amajala/hello/nnac/frontend/scale.npy")
b = np.load("/remote/us01sgnfs00562/NNSDK/amajala/hello/nnac/frontend/bias.npy")

with torch.no_grad():
  layer_norm.weight.copy_(torch.tensor(s))
  layer_norm.bias.copy_(torch.tensor(b))

x = layer_norm(torch.from_numpy(x))
print(x.shape)
